<?php

namespace Trinity\LibuBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * LibroRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class LibroRepository extends EntityRepository
{
	/*
	*  Obtiene libros
	*/
    public function buscaLibros($estatus)
    {
        $parameters = array( 
            'estatus' => $estatus, 
        );
        $query = $this->getEntityManager()->createQuery(
            'SELECT l
            FROM LibuBundle:Libro l
            WHERE l.estatus = :estatus'
        )->setParameters($parameters);
        
        $libros  = $query->getResult();  
        return $libros;          
    }


    /*
    *  Obtiene el código del último libro subido
    */
    public function mayorCodigo()
    {
        $sql = 
            "SELECT codigo
            FROM libro 
            ORDER BY codigo DESC
            LIMIT 1"
        ;
        $stmt = $this->getEntityManager()->getConnection()->prepare($sql);
        $stmt->execute();
        return $stmt->fetchAll();           
    }


}
